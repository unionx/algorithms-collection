#!/usr/bin/env racket
#lang racket

(define rna-string "AUGGCUCAGUCAGAGUCCCAUGUUGACCCGGCCAUUGGGGUGCGGACUCUACGUCCCUUUGACUUGCGCGGUAGUAUCUCAAGCGCGGUAUGGGAAGAACUACCCGGGUCUUUCAAUGGUCACGAGGGUGCUUUCAAACUAUUAACCCUCGGAUCCUCACAUCGCAGGCGGAGAAGUACGCCGAGUGUCAUGGUCGCCGACGAUAACAACUACAGUGCCGUGCGGCGCACGAUCUACCUUAGGUUAUCAUAUUCGGAGGCAUAUCCAGCCGCGACCGCCUACAGUUCGACCGUCAGUCACCGAUCAUGGGCCAAGUCUCACAUGUUUAAGCGUGGAUCGUCACCGGCGUGCAUUCAGUUUCCGUAUGUCCAAGCGAGGGCAGAGUCAAUUGAUUUGGCCGCGCGCUCGUUCCUAGUUUUAAACACGGAUCUCUAUGAACCUUCGCGUGGAAAAUGUUGGUGCGGCAUUACCCUUGGCAAUAGGAGGCACCUUAGGCGACGGAGAAUUUGUCAGAUUUCGAUCCGUGCACAGGGGAGCGAGUCCCGAACUCAAGCGCUCUCCUACAACAUGGUCCGCAACGGCACUCUUGCCAUUUCCGAUUUAUGCGUUCACGACCGUUGUAGAGGCGGCCCGGUUUACAUAUCAGUGAGAGCCCAUUUUAGCUUUAGCUCUUGUAGGGGAGGAAGUCGUGGCCCGAAAUAUUACCCGUUGUUUCGGGCGGAUACGCCUGGCUUAGGCGAACUGUCCCGUGUAGUUGGUACCGCGGUCCGCUUCGUGAACUUUUCCACCCUCCUAUUACUCGCGAGGUUUCGUACGAAGCACGGCUUCAUGAGGUGCUCAUUUACCGUGGACUGCUCUCAAAGGAGUCGUGUCGGAGAUCUCUGGUCAAUGCCUUAUUUGAAGACACUGCUUGGGAUGCCCAGCCUCGGUUCCCCACGAACAUUUAUAUUGAUAAUGCAGUCAUUGAGUAGGUGUGGUUGGACAGCGGAUAUCGGUCGGCAACACCCCGCGGCUUACUCACCCUAUUAUCAGAACCCCCAAGCGCAUAACGUAGUCACUCCUGUAAGCCGAAAUAUGAAGCAUAUGUCUGUCCAAAGAGAGGUCGAUUCGGCGCCAGACUCUCAAACGAUUGCAUACAUUGAGCUAAUGAGUUGUUCGAGGCCCGCCGCCACAACUGAACUGAUGCCAUCCACGGGUAGGGCGCAGAGAAUCUAUUACUCGAGGUCACGACAUAGCUGUUGCAUCUUAACCAGAGUUUCCGUUGGCUUACUUAGACGACCGGUGAUAGCAACAGCGGGAGGGCCCUCAUCGGUCAUCGACUACCUGUCCCCACCCAAUGUGAGAAUUGUUAAGGUUGCACGAUGGGAACCCUACGGUGAGGCGACCUGUCAACUGCGACUCCUUCGUGCCGAAGAGUCAAAGUGUCAAUUCCGCUUGUACAGUCGGUGGACGCUAUGGUGUCGUAAAGCAGAAGGGAACAGCAGGUUAGCUAGAUUCAUUUCGAGCUUACAGGAGAGAGCCCUCAAUCUUAGCAGACCCGUCGGUUUCGACCGCCUUAUCGUGAAUAGCGACAUGAUAGCACGGCCGAGAUCUCGCUCCCAGCGUAAUGCUUACUGCGAUCCGUCGCUUGGAGUAUGCUCCCAAGUUCUUAUCUAUAAAGUGCUUUUGUGGAAGACGCAUCCAUCCAGUAAAUUAGUAACAUUUGCAGGAAUGCAAUGGACUCGAACGGUAGCACGUAAGUUCGUGAAUUCGAGUGUCUUAUGGGUCUGUUCAGAAAGCGUCAGGCAGUUUCUCUGGUCCGUGAGGACGUUGGUAGUUCCGGGAAAAGUCCCUUCGGUCCCAGCUAGCUGGUGGUUCCGCCACCGUCUGCCGCCAAGAAGUCUGUACGACGCCGUAUCAAGAAGGGAAGUACCAUGUAUGAAAGCAACGACGACAUGCGACCCCCGCACAAGGGUCCACUACUCGAUGGAGGGUAGUAGCGCUAUGUCCUGGUGUCCACAGACCAUCGAAAACGCACAACCGGUCACUUACUAUCGCGAUACCUACAGAGCGAUGUCAACCAGUCGGCGUUGCAGUGAAGGUCUCAUGACCGCCCGCGUCCCGUUAGCUGACUAUGUUUUCAGCCCCAUCCACCUCAUUGAACUGACUUACCAAGGUUUCCAUAUACACAAAAUGACUCGAGUCUUCAUUCGCACCUUGAGCUGCCAAUCACUUAUACUCUCCAUGUUGUGCCGUGGCUACAAGGCGCAUGCACUGUUUAGCAAUUACGUUACCGCUACCAUAGCUGACAGGGCUAGCAAUUGUCCCUUUUCUUUGACCGGUAAACAUAGGCUGAACGCUCUGCUCGUGCGGCUCCUGAUCGGCGCGACAUUCCAGAAUAAGGUUACAACGCAUGUUAAAUUAGUCGAAGCCCCCCCUAAUCUCAAAGCUUGCAUGCGCAAUAGCAAGAGUCAAUAUCUGUGCAGUAAACUGCUUUGCCAUGCAAUUACAAUUUGUACUGGUGAUCGUUUACAGAGGGCCUUAUUAGCCGACUCCAGUCCCGUACCGAUCGGCCCCGGACGGCCGUAUCCGUCAUCAAUGCUAUAUACCGAGUACGGAUAUAUCUACCAUCACCUAGCCGUGCUUCCGCGGUAUUGCUUCUCUAGCGGCAGUUUUGCCACGCGUAAAAAUGUCGAGCUGGGGUUGCCUCCCGGCCAAAUCCGAAAAACCGGCCACCAGGGUUUAGACCACGUCAUCCCCAAUCGCAUCAGACCAAACCUUCUUUUCGGUCAGCAGAGCAAAGAUACGGUAUGGACCAGGAUGCCCGGGCUGCGGAGGUACUCGGACCCUUUUAAACUUGGCAGCUCGCCUUCGGCCUUCGCGCAGCCAACGGUUGGGGGUAUGCGCAUCCUGAAUCGACAAACAAAGAAUGAUCCAAGGGAGUCAUUUGGUAUUGACGCAGCUCUCUGGGGACGGUCGCAACGACGGAUAUUACUCGUCCCAAACACGCGACAAUCUAUCACUCACGUGGUUCGUCCCCUAAUAGCCGGAUUCUCAGAUAGUUUGGAUUGGCCUACCCGCACGCACGGCCAUUCAGGCAGGGGUUGGACGCGGGCGCACGCAGAGGUCGUUCGGAACGUUGCGCCGUUUCCGACAAGAGCUUUGCCCUGCAUCAGCCAGCACCUCCUGCUGUUCGCGUACGAUGCUGAUGUCAUCUAUUUUGCAACCACGUAUCGGGACAUGCUAUGCAGAGUUCCAAAGGGAUUGUCGAAUCAGUCGCGCGCCCGAAGUAGCCCAGAUUGGCUAGGAUUUGAUAUUGACACGGGUAUCGUCGACAAAAUGCUCGCUUUUGCAGCCCAGGUCGCCGCGGAGUCUACAGACCUGCGACCCCACGCCCCUCAUUGCAUCGGGUCUGCGGGUGUCUCGACGGCCAGCGACCAGAGGGGGAGACGGAGAGUAUGUUCCCCAUUGGUCACCGCCUACGGUACAAACUGGAGCGUAGACACACUGGUUACUCAAGGCACCCCCACUGUCAUGUGCGAGCAUGAGAGGCACGCGUUAAAGUGCAUUCAACCAAAGAGCGAAGGACGUCGAUUUCCGCUGGACAUAUUGCAGUUGCACGAAUUCUUAAUAUCAGUCGGAAACCGGUCUCCGGUAUUUGGUUGGCCUGUGGUGUUGGAGGUUGCCACGAAACCCUAUUUCCCGAUAUCGAAGAGGCUCUUGUGGGGUAUAGUGCCAUGUGAUGUCUCCUCUCAGAGGUCGUCGUCCGCCCCACGUUGUAGUUACUCUCCUUUGGUUUUUCAGUUUUGCUCAAACGGGUGCGCUGACGGACACUUUUCCUCAGAUCAUUCUCUUCGUAUGUCUGCCGUUUUUUCCGAUCGUCUGCUUGUUAAGGGCCACAGAGAUCGUGUAAGACCUACCCACAUAACCGCACCUGUCGCACUGCUGGGGGAGCAGGUUUACUGCAGACCUGUACUACCCCCCACCCGUCUUUCCGGCUGGACCCAGUACCUCACGGUGAGGUCUCUCGCACGCACAUUACUAGAGUGUUACCCAAAGGGCAUAAUACCGCCUCAGAACUCAACGUCACGGGAGAUCUCAUUGAGAUUAAGGCCCUUCUUCUUUCGUAUCGGGACACGUAUGAAGCUGGCAUGUUGCUUGAGUUCUGGGAAGAUUCGGUUGGGUGAGGUCAUUGAUCUCCGCAGUAACCUGCCUGCGCGUAGUCGACCAAGACUCUCUUGGGGGACACUUCAUUCAUACCCUUCAAUCUCCCAUUACCAUAGCCAACUGAGGCUAACCUCAGUGAAUCCGGGUUGCCGCGGUGUCAGAACCGUCCUCCCCUGGUGCCUGGGGGCUGUGAUAGCUAUGUUACUUGGCGGUACUUGUACUGUACGCUACGCCCGGCGAUACCCCACCAGACCCGACCCUCGAUUCGUAGUCUCUCCUACUCCAACUCAAAGCCGCUCGUGCUAUAGGCAGUUUGUCAGAUGGUCAGUGUCACUCAAAACGUAUCUUCGGGUGACGGGACCUGGGAGCUUACGCCCAUCAGAAGAGAUUCGAGACUCACGGGCCAGUUUCGAGUACAAAGAACGCGCAUCGACACGAUACAAAAAUAAUUGGACCGCGCGGGCGCGGCUCUCUAAGACGAAAGUUAUGCUCCGAUCGCUUUCUUGCAGAGCCUUGAUGAGUGUAGAUGAAAGUACCGGCGCUGAACGUCACUCAACGAGGACCGUGAACGGCCCUCAAGUUACAUGUAGACCCUUUGUAGGCCUCAGUCCAUACUGUUGUCACAGUCCAAGUUCCGAGUCAUCCUUCAAAAUCGGAUUUGAAUUUGUAGAUCCGCCGGCAGAGAAUGUCGAGUUGUCGUCAUCUUCGCCCUACACCAAUGCCCCCAAUGCGUUCCGACCCCUCCUUUUUAACAGCAUCCUCCCAUAUCCAAAGCUCAGGAAUCCAGGCUCUGUGGAUCGGCCGAUCCGGUCAGUGACCUCGGGAAUGCCGGGAUACAAUCUAAUGCCCCAUAUAACACUGAACAAAUGGGCAUGGCGAACAAGUCCUGGCACCCAGAUUUCUCGACCUUCUAGUCAGAGCGCGACUCGAUUGAUUUCACACCCACUGUCAUAUGCCAGCGGACGUACGUGUGUCAAGCGCCGUCAGGUAGUACUGACCAGUCGGGAGUUGACCCCCUGGUUGGGUAGACUCGAAAUUAGGCCAAAGACACCUUAUCUUUCCAUUGGCCAUUUAUGGCAUGCGAUUGAGUUAGGCCACUCUGUGGCAGUCUCAUCAACUUAUCAUUCGAAGGGUAUAGUUAUGGCUCCUUGUUUCACUCUCUAUUAUGCUAGUGAAUCUGAUUCCCACUGGAGGGAUCUUAUAAACCAGGCUGACUUUAUGAACAACGCAGUAGUGGGUCUACUUGCACAGGGACGCACCCGCGCGCAAGUUAUCUUACCAGUGCGGUAUUUGCCUAAGCCAGCUUUUCCAUCCGCGGAUCCGUUCGAUGCGUAUUACUUAGUCAACUUGCCGCUUGUGUUUGGAACUUCGGUUGCAGAUCAACGUUGUAAUAUGGUACUGCCUGGCACGGGACUCUCUUUGGGUCGCACAAUUAACGCCCAUCACUCUGGCGGAGCUAAACACCCUCUUCGUAUGCCGGGAUGCCAGCCAGGAAGGUGUAAGGCAUGUAGUGAUGGUAGUCUCACUCGUGCGGCCGCCUGUCUCCUCUCACUUGCAAAGUCAUCCUAUGUGUCCUCCGUCCCAGUGGGGCGAGGGUCAACUCGAACCAGCGCGAUGCUUAUCUAUAUUAGGGGUGAUAGAAGUCCUAUUAUAUCCCAAAUUUCUGGCGUUUGGGUCGUUGUCAGUGAGUUCUCAGCUCGACAGAAUACAUUCCUGAGAAGAGUUGUAAGAAACCAAAUCAUUAACACACUGUCAAUCAGUGUGCUCCGACUAGCGGGACAUGAAAAUAUAAACCCUCAAGUCCACCGUGCCUGGGUCUUCCUAAAUCCAACUCCGGCGAUCGGACGUCGGCGUACCUUCUUCCAAGCUUCGUGUCUGAUGUCGUCACUGGACGAUGGGUCGAAAAUUGCAUCAGCCACUGUGUCGCUGAUCGUUCGCGGUGUACGAGCAGGACCCUUUGCGGUAACCUAUGUACAUCGGAAGAUCAUAUGCACGUUGAAGCUACAAUUAUUCGUCCGAACGUAUGUGAUUAGGAUCAGACAGUUAGAAAUCCUGACUUCGCUCGGACGGGUUGUCCAGUACUUCGGUUCGGUUAGAGGAAGGGGGGUCGUCUACAUUGGCUUAGCGAAUAUUUCUGAUCUUUAUCAGCCUCUGCUCUCAAAAAUCGCCAUCCUGCGAGGUUGCCAUACUAGAAGGAAUGCGCGGGCUAGGCCCCGGGAGCCUAGCCGCAUGACAGGGAAGGCAAAGUGUGUAUCAAGUCCAUCAUGCCUCCCUUUCUUAUGUACACGAUUAUGGCUUACUGAGAUUCUUCGCUACUGGCCUACCUUAAUUCUAUCCCUGACACAUAGGGUUAAGUAUCAAUCGCCAGCGUUAAGGUGCAAGGCGCGUAUAACGAAUGGCAGUACUGAGUACAUGGCUAAGCUCUUAUGGGUUAGAAGCUCUUGUGCUUUAUUCACAUUCGCAAAGAGCACGGGUUUACACCCACCUUUUAAGAUAUCUUCACUCCUAUUCGCGAGUUUUCAUGUAGGGUGUCAGUGCGGAAUCAUUAACGUGGACCUCGCAUCCGCAAGGUUUGUGUCGCUAGCGUAUGGCGGGGCUUUAUGGGAAAGGGACCCCGACAUGGACUUAUACAGUGUGUUUUUGGGUCUCUCGACACACACACCAAAUCACGGCACCACUAAUAACGCGCCUUGCGGGUACAAAUAUUGCUUUUCCGACGGGCUUUGGGGUCUUUCUGCAAGUCGGGAAUCUGCUAUAGACAGUGCCCAAUCUCGUAAAAAAGUCCUUCAGCUACAGAUCUCACUUUGUGCCCUACGAGUCGACCCAGGACAGGCUACCGCACGAUCGACGAUCCACCCGGCCCCACUAGUUGAGAGAGACUGGUCCGGACGCUGUGUGUCAGUCAGAAGGUGUUCAAUCCCGAGAAUUUUCUGCGACCGUCGUCGCCCGCAGCCUAAUGGCGUACUGUGUCGGGUCUGUUCCAUAGGGGCAAUGUGUGAGCGCACUACACGGCUUCACCGUCAACGAUCAGGGCAUUUUAUUGUCGGGUCACAACCGUCUCGAUGGUACGGGAAACGACAACUUAUUGGAAAUGAUCCUCAUACCUCACCUUACUACCUAUCGAGCUUUAAAUACCAGGAUAUUUCUUUCUCCUGCCGCCACAUGGUUCUUACUGUUGUAAUUUUGACAAUGUCGCUCGAUGUCUUGCCAAGGUCACGUGGGUCCAUAAGAGCCUUCUCUCAGGGACUCCUCCAUUGUACGGCCGCCUAUGAUAAAGUUCGCCGUUCUACCCCUCAGGCUUAUGAUCUUACGCGCUACCUGGGGAGAAGCCUCACGUGCGGAUCUCACCCCUCACUGAUCAGCACGCCCCUAGCGGAUUUAUGGAAGAUAAUAGAGCGUUGUCCUCUGGUGCCGCGAACAUCCCUCGCUAUCCGGUCACUCGGACUAUCUAUGUGCCAGAAUGCUCGUGUUCGGAGGCAAAGUGUCCAUCGUAUCGGCAACGCACACUCAUGGCUACUACAAUGCCACUGGUGUUCUCUAGGUACCCGUCCUGUGUACUCAAUUCGCCAAUCCUUCAGUGGUAUGUUUAGCCAUGAACUGCGAUACAGUCAUGGGACCCUAGGCCCACAUGAGGGUAUGGAUAAAAUGCACAAGCCUACCACAAGUCACCUAGUGACAGCCGGAGUGUACACGAAUGCCGGAGCUCACGUUCACGGCAAAAGCCCGAUUGAAGUCCGGAGCAAUCCCGAGACAAUGAUGAAGAUUGUCGACAUUAUCUGGGCACGGGUGUACCGCCGAAGGGUACCAUUGUAUUCCCCUUUUCCCACUAAUUUUACCACGUCUCUCCCAACUUUCGCGCUUCCAUGGUUGUCCCGGUUGGAAGUCGUCGGCUUAUCAUAUCUAAAUUCGUGCCCGUUCCGCCUCCGUAAAGACCAUAGGUUUCAAGUGGAAAAUCGUGUUCUUUUUGGGCGUGACUACGGACAACCCGGACAGACUCUUCGAACCAGCGGUGAUACAUGUUACCAGGCCGCCAAGAAAACCGUUUCAAACAUUCCCAAGCGUCUAUCGCCGUAUGACCAUAAGCGUCCUCUUCGCGGUGUUAUCAAUUGCUGCGGUUGUGUGCCCGAAAUUAUUUUAGUACUGUAUGUGCAUUACUUGGGCAUGGUCGAUAUGCAGUAUGGCGACGGUCGGCCACACAGGUCGUGUCCGAGUAUCUUUCGUCCCCUUUCCUCGGAUUAUUCGUAUAGUUCGAUUGUGCCUAAUCUAAUCCCGGUAGGACACGUCUCGGAUGAUAUGGUCACGUCUCCUACCUCGUGCAAAUGCGACUUAGAUAGAACGCGGGAGAAGUGUUCUCUAGCUAGGGAUCUCUACUCCGCAAUUGUAAAGGUUUAUACGGUAUAUAAGGUCAUGCUGAUGAAAGUCCUGUGA")

(define codon-hash (make-hash))

(define (read-codon-file in)
  (let ((codon-line (read-line in)))
    (if (eof-object? codon-line)
        #t
        (let ((codon-line-split (string-split codon-line)))
          (hash-set! codon-hash
                     (first codon-line-split)
                     (last codon-line-split))
          (read-codon-file in)))))

(call-with-input-file "./rna_codon_table.txt"
  read-codon-file)

(define (decode-rna)
  (define (repeat-replace-rna rna-string protein-string)
    (if (string=? rna-string "")
        protein-string
        (let* ((this-codon (substring rna-string 0 3))
               (this-amino-acid (hash-ref codon-hash this-codon)))
          (if (string=? this-amino-acid "Stop")
              protein-string
              (repeat-replace-rna (substring rna-string 3)
                                  (string-append protein-string this-amino-acid))))))
  (repeat-replace-rna rna-string ""))


(displayln codon-hash)
(displayln (decode-rna))
